# SBMtrees 

This R package, SBMtrees (Sequential Imputation with Bayesian Trees Mixed-Effects Models), implements a Bayesian non-parametric sequential imputation framework designed for longitudinal data with missing covariates and outcomes. The framework consists of two levels: at its core is the Bayesian Trees Mixed-Effects model (BMTrees) and its variants, upon which longitudinal sequential imputation is applied to effectively perform multiple imputation of missing longitudinal covariates and outcomes under Missing at Random (MAR) assumptions.

The Bayesian Trees Mixed-Effects Model (BMTrees) builds on the foundation of Mixed-Effects Bayesian Additive Regression Trees (Mixed-Effects BART), enhancing its flexibility and extending its applicability to more complex scenarios. While Mixed-Effects BART effectively models non-linear associations and random effects, it relies on parametric assumptions for their distributions. In contrast, BMTrees employs centralized Dirichlet Process (CDP) Normal Mixture priors with a mean of zero for both random effects and random errors. This nonparametric approach enables BMTrees to handle non-normal random effects and errors, addressing model misspecification and offering greater adaptability for capturing intricate relationships in longitudinal data. To accommodate different modeling assumptions, we also define another two semiparametric variants of BMTrees.

Building on BMTrees, we developed a longitudinal sequential imputation framework that leverages a Metropolis-Hastings (M-H) Markov Chain Monte Carlo (MCMC) method. This framework establishes a fixed order for covariates and, at each iteration, sequentially constructs univariate models using BMTrees to impute missing covariates based on previously imputed variables in the specified order. The imputed values are then used to calculate predictive probabilities, followed by an acceptance-rejection step guided by these probabilities. This approach maintains the simplicity of univariate conditionals while ensuring that the imputations align with a valid joint distribution consistent with the inference model.

For more details on these estimators and their applications, please consult the following paper: "Nonparametric Bayesian Additive Regression Trees for Predicting and Handling Missing Covariates and Outcomes in Longitudinal Data".
